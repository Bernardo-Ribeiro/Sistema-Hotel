CREATE DATABASE IF NOT EXISTS SistemaHotel;
USE SistemaHotel;

CREATE TABLE Funcionarios (
    FuncionarioID INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL,
    CPF VARCHAR(14) UNIQUE NOT NULL,
    Telefone VARCHAR(15),
    Cargo VARCHAR(50),
    Endereco VARCHAR(200),
    Email VARCHAR(100),
    Salario DECIMAL(10, 2),
    DataAdmissao DATE DEFAULT (CURRENT_TIMESTAMP),
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE Hospedes (
    HospedeID INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL,
    CPF VARCHAR(14) UNIQUE NOT NULL,
    Telefone VARCHAR(20),
    Email VARCHAR(100),
    Endereco VARCHAR(200),
    DataNascimento DATE,
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE Quartos (
    QuartoID INT PRIMARY KEY AUTO_INCREMENT,
    NumeroQuarto INT UNIQUE NOT NULL,
    Tipo ENUM('SOLTEIRO', 'CASAL', 'FAMILIA', 'LUXO') NOT NULL,
    PrecoDiaria DECIMAL(10, 2) NOT NULL,
    Status ENUM('DISPONIVEL', 'OCUPADO', 'MANUTENCAO') DEFAULT 'DISPONIVEL',
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE Reservas (
    ReservaID INT PRIMARY KEY AUTO_INCREMENT,
    HospedeID INT NOT NULL,
    QuartoID INT NOT NULL,
    DataCheckIn DATE NOT NULL,
    DataCheckOut DATE NOT NULL,
    Status ENUM('CONFIRMADA', 'CANCELADA', 'CONCLUIDA', 'PENDENTE') DEFAULT 'PENDENTE',
    ValorTotal DOUBLE NOT NULL,
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (HospedeID) REFERENCES Hospedes(HospedeID),
    FOREIGN KEY (QuartoID) REFERENCES Quartos(QuartoID)
);


CREATE TABLE Pagamentos (
    PagamentoID INT PRIMARY KEY AUTO_INCREMENT,
    ReservaID INT NOT NULL,
    ValorPago DECIMAL(10, 2) NOT NULL,
    DataPagamento DATE DEFAULT (CURRENT_TIMESTAMP),
    MetodoPagamento ENUM('DINHEIRO', 'CARTAO_CREDITO', 'CARTAO_DEBITO', 'PIX', 'TRANSFERENCIA') DEFAULT 'DINHEIRO',
    FOREIGN KEY (ReservaID) REFERENCES Reservas(ReservaID),
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE Produtos (
    ProdutoID INT PRIMARY KEY AUTO_INCREMENT,
    NomeProduto VARCHAR(100) NOT NULL,
    Preco DECIMAL(10, 2) NOT NULL,
    Estoque INT NOT NULL,
    Categoria ENUM('FRIGOBAR', 'RESTAURANTE', 'BEBIDA', 'OUTROS') NOT NULL,
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE Consumo (
    ConsumoID INT PRIMARY KEY AUTO_INCREMENT,
    ReservaID INT NOT NULL,
    ProdutoID INT NOT NULL,
    Quantidade INT NOT NULL,
    Valor DECIMAL(10, 2) NOT NULL,
    DataConsumo DATE NOT NULL,
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (ReservaID) REFERENCES Reservas(ReservaID),
    FOREIGN KEY (ProdutoID) REFERENCES Produtos(ProdutoID)
);

CREATE TABLE Servicos (
    ServicoID INT PRIMARY KEY AUTO_INCREMENT,
    NomeServico VARCHAR(100) NOT NULL,
    Descricao VARCHAR(255),
    Preco DECIMAL(10, 2) NOT NULL,
    Disponivel BOOLEAN DEFAULT TRUE,
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE ConsumoServicos (
    ConsumoServicoID INT PRIMARY KEY AUTO_INCREMENT,
    ReservaID INT NOT NULL,
    ServicoID INT NOT NULL,
    Quantidade INT NOT NULL,
    DataConsumo DATE DEFAULT (CURRENT_TIMESTAMP),
    FOREIGN KEY (ReservaID) REFERENCES Reservas(ReservaID),
    FOREIGN KEY (ServicoID) REFERENCES Servicos(ServicoID),
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE Manutencao (
    ManutencaoID INT PRIMARY KEY AUTO_INCREMENT,
    QuartoID INT NOT NULL,
    DataInicio DATE NOT NULL,
    DataFim DATE,
    Descricao TEXT,
    Status ENUM('PENDENTE', 'EM_ANDAMENTO', 'CONCLUIDA') DEFAULT 'PENDENTE',
    FuncionarioID INT,
    FOREIGN KEY (QuartoID) REFERENCES Quartos(QuartoID),
    FOREIGN KEY (FuncionarioID) REFERENCES Funcionarios(FuncionarioID),
    DataCriacao DATETIME DEFAULT CURRENT_TIMESTAMP,
    DataAtualizacao DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);